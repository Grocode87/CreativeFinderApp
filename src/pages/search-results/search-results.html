<ion-header>
    <ion-navbar>
        <ion-searchbar #searchbar [(ngModel)]="searchTerm" placeholder="Search for maps and creators" (ionCancel)="toggleSearch();" (ionInput)="searchUpdated($event)" (ionFocus)="onFocus()" (ionBlur)="onBlur()" (search)="searchQuery($event)"></ion-searchbar>
        <ion-buttons end *ngIf="showX">
            <button ion-button icon-only class='header-x-button' (click)="clearPressed()"><ion-icon name="close"></ion-icon></button>
        </ion-buttons>
    </ion-navbar>
    <ion-toolbar *ngIf='toggled' class='search-suggestions'>
        <div>
            <ion-item no-lines (click)="suggestionClicked(item)" class='suggestion' *ngFor='let item of suggestions'>
                <ion-icon class='suggestion-icon' item-start name='search'></ion-icon>
                {{ item }}
                <ion-icon item-end name="arrow-round-forward"></ion-icon>
            </ion-item>
            <ion-item no-lines (click)="suggestionClicked(item)" class='history' *ngFor='let item of history'>
                <ion-icon class='suggestion-icon' item-start name='time'></ion-icon>
                {{ item }}
                <ion-icon item-end name="arrow-round-forward"></ion-icon>
            </ion-item>
        </div>
    </ion-toolbar>
</ion-header>

<ion-content class='content dark-bg'>
    <div class='error-loading' *ngIf='errorLoading'>
        <div class='error-text'>Could not load, check your connection and try again</div>
        <button ion-button round outline (click)='tryAgain()'>Try Again</button>
    </div>
    <!-- Loading Indicator -->
    <ion-item padding class='searching-indicator' no-lines *ngIf="!maps && !errorLoading">
        <h4>Searching</h4>
        <ion-spinner item-right name="crescent"></ion-spinner>
    </ion-item>

    <!-- Categories list (horizontal)-->
    <div *ngIf="categories?.length > 0">
        <div class='result-type'>
            <div class='type-text'>Categories</div>
        </div>
        <div class='category-list'>
            <div class='category' *ngFor='let category of categories' (click)='viewCategory(category.name)'>
                <img src="{{category.img_url}}">
                <div class='label'>{{category.name}}</div>
            </div>
            <div class='e-slide'></div>
        </div>
        <div class='spacing'></div>
    </div>

    <!-- Creators list (horizontal)-->
    <div *ngIf='creators?.length > 0'>
        <div class='result-type'>
            <div class='type-text'>Creators</div>
        </div>
        <div class='creators-list'>
            <div class='creator' *ngFor='let creator of creators' (click)="viewCreator(creator)">
                <img src='{{creator.img_url}}'>
                <div class='creator-text'>
                    {{creator.name}}
                </div>
            </div>
        </div>
        <div class='spacing'></div>
    </div>
    <!-- Maps header and # of results-->
    <div class='result-type' *ngIf='maps?.length > 0'>
        <div class='type-text'>Maps</div>
        <div class='right-text'>{{maps.length}} Results</div>
    </div>
    <!-- Maps list -->
    <virtual-scroller #scroll [items]="maps" [enableUnequalChildrenSizes]="true" [bufferAmount]="10" *ngIf='maps?.length > 0'>
        <map-item *ngFor="let item of scroll.viewPortItems" [map]='item' [content]='content' [doShowDesc]='true' [aSource]='Search'></map-item>
    </virtual-scroller>

</ion-content>